(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{160:function(e,t,a){e.exports=a(348)},165:function(e,t,a){},197:function(e,t,a){},348:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(25),s=a.n(o),i=(a(165),a(89)),c=a(30),l=a(31),u=a(33),h=a(32),d=a(35),m=a(34),p=a(52),g=a(20),f=a(133),b=a.n(f),E=a(22),v=a(24),y=a(134),w=a.n(y),C=a(41),O=a.n(C),S=a(82),j=a.n(S),k=a(40),I=a(42),M=(a(197),a(15)),A=a.n(M),F=a(16),x=a.n(F),U=a(38),N=a.n(U),P=a(139),K=a.n(P),T=a(88),R=a.n(T),L=a(140),D=a.n(L),B=a(17),z=a.n(B),H=a(29),V=a.n(H),W=a(142),G=a.n(W),J=a(28),_=a.n(J),Z=a(83),$=a.n(Z),q=a(36),Q=a.n(q),X=a(37),Y=a.n(X),ee=a(141),te=a.n(ee),ae=a(147),ne=a.n(ae),re=a(145),oe=a.n(re),se=a(146),ie=a.n(se),ce=a(138),le=a.n(ce),ue=a(144),he=a.n(ue),de=a(84),me=a.n(de),pe=a(137),ge=a.n(pe),fe=a(136),be=a.n(fe),Ee=a(148),ve=a.n(Ee),ye=a(62),we=a(86),Ce=a.n(we),Oe=a(85),Se=a.n(Oe),je=a(61),ke=a.n(je),Ie=a(60),Me=a.n(Ie),Ae=a(53),Fe=a.n(Ae),xe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).handleSearch=function(e){a.props.handleSearch&&a.props.handleSearch(e)},a.handleSwitch=function(e){a.props.handleSwitch&&a.props.handleSwitch(e)},a.handleProfileMenuOpen=function(e){a.updateStateAttributes({profileMenuAnchorEl:e.currentTarget})},a.handleFeatureMenuOpen=function(e){a.updateStateAttributes({featureMenuAnchorEl:e.currentTarget})},a.handleProfileMenuClose=function(){a.updateStateAttributes({profileMenuAnchorEl:null})},a.handleFeatureMenuClose=function(){a.updateStateAttributes({featureMenuAnchorEl:null})},a.state={featureMenuAnchorEl:null,profileMenuAnchorEl:null},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"updateStateAttributes",value:function(e){var t=Object(g.a)({},this.state);A.a.forEach(e,function(e,a){t[a]=e}),this.setState(function(){return t})}},{key:"render",value:function(){var e=this,t=this.state,a=t.profileMenuAnchorEl,n=t.featureMenuAnchorEl,o=this.props,s=o.classes,i=o.handleLogout,c=o.reloadAll,l=o.grantAll,u=o.features,h=o.setFeaturesEnabled,d=o.admin,m=o.subscription,p=o.userId,f=Boolean(a),b=Boolean(n),E=function(t){!function(e){var t=Object(g.a)({},u);t[e]=!t[e],h(t)}(t),e.handleFeatureMenuClose()},v=function(){h({presence:!0,accessManager:!0,functions:!0,storageHistory:!0}),e.handleFeatureMenuClose()},y=function(){h({presence:!1,accessManager:!1,functions:!1,storageHistory:!1}),e.handleFeatureMenuClose()},w=r.a.createElement($.a,{anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:f,onClose:this.handleProfileMenuClose},r.a.createElement(_.a,{onClick:i},"Log Out")),C=function(e){return e&&r.a.createElement(me.a,null)||r.a.createElement(be.a,null)},O=r.a.createElement($.a,{anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:b,onClose:this.handleFeatureMenuClose},r.a.createElement(_.a,{onClick:this.handleFeatureMenuClose},r.a.createElement(Q.a,{className:s.icon},r.a.createElement(me.a,null)),r.a.createElement(Y.a,{inset:!0,primary:"01: Pub/Sub Data Streams"})),r.a.createElement(_.a,{onClick:function(){return E("presence")}},r.a.createElement(Q.a,{className:s.icon},C(u.presence)),r.a.createElement(Y.a,{inset:!0,primary:"02: Presence"})),r.a.createElement(_.a,{onClick:function(){return E("accessManager")}},r.a.createElement(Q.a,{className:s.icon},C(u.accessManager)),r.a.createElement(Y.a,{inset:!0,primary:"03: Access Manager"})),r.a.createElement(_.a,{onClick:function(){return E("functions")}},r.a.createElement(Q.a,{className:s.icon},C(u.functions)),r.a.createElement(Y.a,{inset:!0,primary:"04: FUNCTIONs",title:"Enables Custom Endpoints and Message Processing"})),r.a.createElement(_.a,{onClick:function(){return E("storageHistory")}},r.a.createElement(Q.a,{className:s.icon},C(u.storageHistory)),r.a.createElement(Y.a,{inset:!0,primary:"05: Storage & History",title:"Enables Fast Load Times and Context Initialization"})),r.a.createElement("hr",null),r.a.createElement(_.a,{onClick:function(){return v()}},r.a.createElement(Q.a,{className:s.icon},r.a.createElement(ge.a,null)),r.a.createElement(Y.a,{inset:!0,primary:"Enable all"})),r.a.createElement(_.a,{onClick:function(){return y()}},r.a.createElement(Q.a,{className:s.icon},r.a.createElement(le.a,null)),r.a.createElement(Y.a,{inset:!0,primary:"Disable All"})),r.a.createElement("hr",null),r.a.createElement(_.a,{onClick:function(){return c(),void e.handleFeatureMenuClose()}},r.a.createElement(Q.a,{className:s.icon},r.a.createElement(Fe.a,null)),r.a.createElement(Y.a,{inset:!0,primary:"Send RELOAD to all Users"})),r.a.createElement(_.a,{onClick:function(){return l(),void e.handleFeatureMenuClose()}},r.a.createElement(Q.a,{className:s.icon},r.a.createElement(Fe.a,null)),r.a.createElement(Y.a,{inset:!0,primary:"Initialize PAM"})));return r.a.createElement("div",{className:s.root},r.a.createElement(K.a,{position:"static"},r.a.createElement(x.a,{container:!0,justify:"center"},r.a.createElement(x.a,{item:!0,style:{width:"95%"}},r.a.createElement(D.a,null,r.a.createElement(V.a,{className:s.title,variant:"h4",color:"inherit",noWrap:!0},"WeatherLIVE!"),u.accessManager&&"basic"===m&&r.a.createElement(Se.a,{icon:r.a.createElement(Me.a,null),label:"Basic Subscription",className:s.chip}),u.accessManager&&"pro"===m&&r.a.createElement(Se.a,{icon:r.a.createElement(ke.a,null),label:"PRO Subscription",className:s.chip}),u.functions&&r.a.createElement("div",{className:s.search},r.a.createElement("div",{className:s.searchIcon},r.a.createElement(te.a,null)),r.a.createElement(G.a,{placeholder:'"City, State" or ZIP',classes:{root:s.inputRoot,input:s.inputInput},onKeyPress:function(t){"Enter"===t.key&&(e.handleSearch(t),t.preventDefault())}})),r.a.createElement("div",{className:s.grow}),r.a.createElement("div",{className:s.sectionDesktop},r.a.createElement(Ce.a,{component:ye.a,to:"/weather",color:"inherit"},r.a.createElement(z.a,{color:"inherit"},r.a.createElement(R.a,{badgeContent:this.props.weatherCount,color:"secondary"},r.a.createElement(he.a,null)))),u.presence&&r.a.createElement(Ce.a,{component:ye.a,to:"/users",color:"inherit"},r.a.createElement(z.a,{color:"inherit"},r.a.createElement(R.a,{badgeContent:this.props.userCount,color:"secondary"},r.a.createElement(oe.a,null)))),u.accessManager&&r.a.createElement(z.a,{"aria-owns":f?"material-appbar":void 0,"aria-haspopup":"true",onClick:this.handleProfileMenuOpen,color:"inherit"},r.a.createElement(ie.a,null),p),d&&r.a.createElement(z.a,{"aria-owns":b?"material-appbar":void 0,"aria-haspopup":"true",onClick:this.handleFeatureMenuOpen,color:"inherit"},r.a.createElement(ne.a,null)),r.a.createElement(ve.a,{checked:this.props.enabled,onChange:this.handleSwitch,color:"secondary",title:(this.props.enabled?"Pause":"Resume")+" realtime updates"})))))),w,O)}}]),t}(r.a.Component),Ue=a(155),Ne=a.n(Ue),Pe=a(151),Ke=a.n(Pe),Te=a(149),Re=a.n(Te),Le=a(150),De=a.n(Le),Be=a(152),ze=a.n(Be),He=a(153),Ve=a.n(He),We=a(54),Ge=a.n(We),Je=a(154),_e=a.n(Je),Ze=a(63),$e=a.n(Ze),qe=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.onClose;return r.a.createElement(Re.a,{open:!0,onClose:a,"aria-labelledby":"simple-dialog-title",fullWidth:!0,maxWidth:"sm"},r.a.createElement(De.a,{id:"simple-dialog-title"},t.city," Forecast",r.a.createElement(z.a,{"aria-label":"Close",onClick:a,style:{position:"absolute",right:10,top:10}},r.a.createElement(Ke.a,null))),r.a.createElement(N.a,null,r.a.createElement(ze.a,null,r.a.createElement(Ve.a,null,A.a.map(A.a.take(t.forecast.forecast.properties.periods,24),function(e){return r.a.createElement(_e.a,{key:e.number},r.a.createElement(Ge.a,{style:{whiteSpace:"nowrap"}},$e()(e.startTime).format("LT")),r.a.createElement(Ge.a,{title:e.shortForecast},r.a.createElement(Ne.a,{src:e.icon,style:{width:"60px",height:"60px"}})),r.a.createElement(Ge.a,null,e.temperature,"\xb0F"),r.a.createElement(Ge.a,null,e.shortForecast))})))))}}]),t}(r.a.Component),Qe=a(64),Xe=a.n(Qe),Ye=a(66),et=a.n(Ye),tt=a(157),at=a.n(tt),nt=a(65),rt=a.n(nt),ot=a(156),st=a.n(ot),it=a(158),ct=a.n(it),lt=a(159),ut=a.n(lt),ht=a(67),dt=a.n(ht),mt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.nowTime,a=e.features,n=e.data,o=e.toggleHidden,s=e.toggleFavorite,i=e.showForecast,c=Math.round(9*n.observation.properties.temperature.value/5+32),l=n.observation.properties.heatIndex.value&&Math.round(9*n.observation.properties.heatIndex.value/5+32),u=n.observation.properties.windChill.value&&Math.round(9*n.observation.properties.windChill.value/5+32),h=l||u||c,d=new Date(n.ts).getTime()/1e3,m=new Date(t).getTime()/1e3,p=$e()(n.ts).fromNow(),g={width:"240px"},f=a.functions;if(f&&h<33?g.backgroundColor="#3030A0":f&&h>=76&&(g.backgroundColor="#A03030"),"a few seconds ago"===p){var b=Math.round(Math.abs(m-d));b<10?(a.functions&&(g.border="1px solid yellow"),p="just now"):p="".concat(b," seconds ago")}return r.a.createElement(Xe.a,{style:g},r.a.createElement(rt.a,{title:n.city,subheader:p}),r.a.createElement(st.a,{component:"div",image:n.observation.properties.icon,title:n.observation.properties.textDescription,style:{justifyContent:"center"}},r.a.createElement(at.a,{style:{height:"160px",paddingTop:"70px",backgroundColor:"#303030",opacity:.6}},r.a.createElement(V.a,{component:"h2",variant:"h2",align:"center",style:{fontWeight:"bold"}},c,"\xb0F"),r.a.createElement(V.a,{component:"h6",variant:"h6",align:"center"},n.observation.properties.textDescription),r.a.createElement(V.a,{component:"p",align:"center"},"Feels Like ",h,"\xb0F"))),r.a.createElement(et.a,null,r.a.createElement(x.a,{container:!0,justify:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(z.a,{title:"Add to favorites",onClick:s},r.a.createElement(ct.a,{style:{color:n.favorite?"red":"white"}}))),a.functions&&r.a.createElement(x.a,{item:!0},r.a.createElement(z.a,{title:"View Forecast",onClick:function(){return i(n.city,n.latlng)}},r.a.createElement(ut.a,null))),r.a.createElement(x.a,{item:!0},r.a.createElement(z.a,{title:"Delete",align:"right",onClick:o},r.a.createElement(dt.a,null))))))}}]),t}(n.Component),pt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.admin,a=e.features,n=e.user,o=e.subscription,s=e.reload,i=e.deleteForever,c=e.setBasic,l=e.setPro,u="Unknown Subscription";return"basic"===o?u="Basic Subscription":"pro"===o&&(u="PRO Subscription"),r.a.createElement(Xe.a,{style:{width:"280px"}},r.a.createElement(rt.a,{title:n,subheader:a.accessManager&&u,align:"center"}),t&&a.accessManager&&r.a.createElement(et.a,null,r.a.createElement(x.a,{container:!0,justify:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(z.a,{title:"Reload",onClick:function(){return s(n)}},r.a.createElement(Fe.a,null))),r.a.createElement(x.a,{item:!0},r.a.createElement(z.a,{title:"Set to BASIC",onClick:function(){return c(n)}},r.a.createElement(Me.a,null))),r.a.createElement(x.a,{item:!0},r.a.createElement(z.a,{title:"Set to PRO",align:"right",onClick:function(){return l(n)}},r.a.createElement(ke.a,null))),r.a.createElement(x.a,{item:!0},r.a.createElement(z.a,{title:"Logout and Delete User",align:"right",onClick:function(){return i(n)}},r.a.createElement(dt.a,null))))))}}]),t}(n.Component),gt=function(e){return{root:Object(g.a)({flexGrow:1,width:"95%"},e.mixins.gutters(),{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit}),grow:{flexGrow:1},chip:{margin:e.spacing.unit},search:Object(p.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(k.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(k.fade)(e.palette.common.white,.25)},marginRight:2*e.spacing.unit,marginLeft:0},e.breakpoints.up("sm"),{marginLeft:3*e.spacing.unit,width:"300px"}),searchIcon:{width:5*e.spacing.unit,height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:Object(p.a)({paddingTop:e.spacing.unit,paddingRight:e.spacing.unit,paddingBottom:e.spacing.unit,paddingLeft:5*e.spacing.unit,transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"100%"}),card:{maxWidth:400},media:{height:0,paddingTop:"56.25%"},actions:{display:"flex"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:j.a[500]}}},ft=Object(I.createMuiTheme)({palette:{type:"dark",primary:{main:"#000000"},secondary:{main:"#C7254E"}},typography:{useNextVariants:!0}}),bt=Object(E.a)(),Et=Object(I.withStyles)(gt)(xe),vt=Object(I.withStyles)(gt)(qe),yt=Object(I.withStyles)(gt)(mt),wt=Object(I.withStyles)(gt)(pt),Ct=window.sessionStorage,Ot=new RegExp(";;"),St=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).handleLocationChange=function(){return function(e){(console.log("location change",e),"/"===e.pathname&&null===a.state.selectedValue&&bt.push("/weather"),"/"!==e.pathname)&&(Object(v.d)(window.location.pathname,{path:"/weather/:city",exact:!1,strict:!1})&&null===a.state.selectedValue&&bt.push("/weather"))}},a.logout=function(){return function(){a.leaveChat(),Ct.clear(),setInterval(function(){window.location.reload()},500)}},a.onStatusChange=function(e){console.log("status changed",e);var t=Object(d.a)(a);"PNConnectedCategory"===e.category&&(A.a.forEach(e.subscribedChannels,function(e){t.pubnub.getMessage(e,t.onMessage),t.pubnub.getPresence(e,t.onPresenceChange),a.state.features.storageHistory&&t.pubnub.history({channel:e,reverse:!1,count:40},t.onHistory(e))}),t.pubnub.hereNow({channels:["control"],includeUUIDs:!0,includeState:!0},function(e,a){console.log("hereNow",e,a),A()(a.channels.control.occupants).forEach(function(e){return t.addUser(e)})}));t.channels&&function(){var e={uuid:t.userId,channels:["control"],state:{subscription:t.channels.length>2?"pro":"basic"}};t.pubnub.setState(e,function(t){console.log("set my state",e,t)})}()},a.setStateAttributes=function(e){var t=Object(g.a)({},a.state);A.a.forEach(e,function(e,a){t[a]=e}),a.setState(function(){return t})},a.leaveChat=function(){console.log("leaving.."),a.pubnub.unsubscribe({channels:a.channels})},a.onHistory=function(e){return function(t,n){if("control"!==e){console.log("history",e,t,n);var r=Object(d.a)(a);A.a.forEach(n.messages,function(t){r.onMessage({channel:e,message:t.entry})})}}},a.onMessage=function(e){if(a.state.enabled)if("control"!==e.channel||"reload"!==e.message.action||e.message.userId&&e.message.userId!==a.userId){if("control"===e.channel&&"logout"===e.message.action&&(!e.message.userId||e.message.userId===a.userId))return a.leaveChat(),void a.logout()();var t=-1!==e.channel.indexOf("basic")?"observationsBasic":"observationsExtended",n=Object(g.a)({},a.state[t]),r=e.message;r.hidden=!!Ct.getItem("hidden:".concat(r.city)),r.favorite=!!Ct.getItem("favorite:".concat(r.city)),n[e.message.city]=r;var o=Object(g.a)({},a.state);o[t]=n,o.allCities[e.message.city]=t,a.setState(function(){return o})}else a.initialize()},a.onPresenceChange=function(e){switch(console.log("presence",e),e.action){case"join":a.addUser(e);break;case"leave":case"timeout":a.removeUser(e.uuid);break;case"state-change":a.addUser(e);break;default:console.error("unknown action: "+e.action)}},a.addUser=function(e){if(console.log("add user",e),e){e.uuid||(e={uuid:e});var t=Object(i.a)(a.state.users);t.includes(e.uuid)||t.push(e.uuid);var n=Object(g.a)({},a.state.userSubscriptions);e.state&&e.state.subscription&&(n[e.uuid]=e.state.subscription),a.setStateAttributes({users:t,userSubscriptions:n})}},a.removeUser=function(e){if(console.log("remove user",e),e){var t=Object(i.a)(a.state.users);t=A.a.filter(t,function(t){return t!==e}),delete Object(g.a)({},a.state.userSubscriptions)[e],a.setStateAttributes({users:t})}},a.toggleExtreme=function(){return function(){console.log("toggleExtreme"),a.setStateAttributes({showExtreme:!a.state.showExtreme})}},a.toggleProperty=function(e,t){return function(){console.log("toggle",e,t);var n=Object(g.a)({},a.state),r=a.state.allCities[e],o=Object(g.a)({},a.state[r]),s=o[e];s[t]=!s[t],o[e]=s,n[r]=o,Ct.setItem("".concat(t,":").concat(e),s[t]),a.setState(function(){return n})}},a.grantAll=function(){return function(){var e=Object(d.a)(a);O.a.post(e.adminUrl).then(function(e){console.log("grant all",e),a.initialize()})}},a.grantUser=function(e){return function(){var t=Object(d.a)(a),n=a.getAuthKey(e),r=a.getFeatures(t.state.features);O.a.post("".concat(t.adminUrl,"?user=").concat(e,"&authKey=").concat(n,"&access=true&features=").concat(r)).then(function(n){console.log("grant user",e,n),e===a.userId?t.initialize():t.sendReload(e)()})}},a.ungrantUser=function(e){return function(){var t=Object(d.a)(a),n=a.getAuthKey(e),r=a.getFeatures(t.state.features);O.a.post("".concat(t.adminUrl,"?user=").concat(e,"&authKey=").concat(n,"&access=false&features=").concat(r)).then(function(n){console.log("ungrant user",e,n),e===a.userId?t.initialize():t.sendReload(e)()})}},a.deleteForever=function(e){return function(){a.ungrantUser(e),a.pubnub.publish({channel:"control",message:{action:"logout",userId:e}},function(e,t){console.log("logoutsend",e,t)}),setTimeout(function(){var t=A.a.filter(a.state.users,function(t){return t!==e}),n=Object(g.a)({},a.state.userSubscriptions);delete n[e],a.setStateAttributes({users:t,userSubscriptions:n})},2e3)}},a.sendReload=function(e){return function(){a.pubnub.publish({channel:"control",message:{action:"reload",userId:e}},function(e,t){console.log("reloadsend",e,t)})}},a.showForecast=function(){return function(e,t){console.log("forecast",e,t);var n="".concat(a.forecastUrl,"?address=").concat(e);if(t){var r=A.a.map(t.split(","),function(e){return t=e,(Math.round(1e4*t)/1e4).toString();var t}).join(",");n="".concat(a.forecastUrl,"?latlng=").concat(r)}O.a.get(n).then(function(n){console.log(n);var r=n.data,o=Object(g.a)({},a.state);o.selectedValue={city:e,latlng:t,forecast:r},a.setState(function(){return o}),bt.push("/weather/".concat(escape(e)))})}},a.handleSearch=function(){return function(e){var t=e.target.value;t&&(a.showForecast()(t),e.target.value="")}},a.handleDialogClose=function(){console.log("dialog close"),a.setStateAttributes({selectedValue:null}),bt.push("/weather")},a.setFeaturesEnabled=function(){return function(e){var t="pro"===a.state.userSubscriptions[a.userId],n=a.getFeatures(e),r="".concat(a.adminUrl,"?user=").concat(a.userId,"&authKey=").concat(a.authKey,"&access=").concat(t,"&features=").concat(n);console.log("enable finagle",r),O.a.post(r).then(function(e){console.log("postadminfeatures",e),a.sendReload()()})}},a.toggleEnabled=function(){return function(){a.setStateAttributes({enabled:!a.state.enabled})}};var n=window.location.hash;console.log("hash",n),a.isAdmin=n.match(Ot),a.url=window.location.href,a.userId=Ct.getItem("userId"),a.userId||(a.userId=a.getUserId(),Ct.setItem("userId",a.userId)),a.authKey=a.getAuthKey(a.userId),a.publishKey="pub-c-e4f389d1-c414-4e09-9db2-2373a8af8222",a.subscribeKey="sub-c-836dc25c-571c-11e9-94f2-3600c194fb1c",a.adminUrl="https://pubsub.pubnub.com/v1/blocks/sub-key/".concat(a.subscribeKey,"/__admin"),a.forecastUrl="https://pubsub.pubnub.com/v1/blocks/sub-key/".concat(a.subscribeKey,"/forecast"),a.pubnub=new b.a({publishKey:a.publishKey,subscribeKey:a.subscribeKey,authKey:a.authKey,uuid:a.userId}),a.state={admin:a.isAdmin,enabled:!0,showExtreme:!1,background:"#aaa",jumpToUrl:"https://pubnub.com",observationsBasic:{},observationsExtended:{},allCities:{},selectedValue:null,users:[],userSubscriptions:{},features:{}},a.pubnub.init(Object(d.a)(a)),a.pubnub.getStatus(a.onStatusChange),console.log("path",bt.location.pathname),"/"===bt.location.pathname&&bt.push("/weather");var r=Object(d.a)(a);return setInterval(function(){r.setStateAttributes({nowTime:(new Date).toISOString()})},1e3),window.addEventListener("beforeunload",a.leaveChat),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"getAuthKey",value:function(e){return w()(e).toString().substring(64)}},{key:"getUserId",value:function(){return"User"+Math.round(1e4*Math.random())}},{key:"initialize",value:function(){this.channels&&this.leaveChat();var e=this;O.a.get("".concat(this.adminUrl,"?user=").concat(this.userId)).then(function(t){console.log("admin",t.data);var a=A.a.filter(t.data.channels,function(e){return-1===e.indexOf("-pnpres")});e.channels=a,console.log("subscribe: ",e.channels),A.a.forEach(e.channels,function(t){e.pubnub.subscribe({channels:[t],withPresence:"control"===t})}),e.setStateAttributes({features:Object(g.a)({},t.data.settings),allCities:{},observationsBasic:{},observationsExtended:{}})})}},{key:"reload",value:function(){setInterval(function(){window.location.reload()},200)}},{key:"componentWillMount",value:function(){if(this.initialize(),!this.locationListener){var e=this.handleLocationChange();bt.listen(e),e(window.location),this.locationListener=e}}},{key:"componentWillUnmount",value:function(){console.log("leaving.."),this.leaveChat()}},{key:"setUserSubscription",value:function(e,t){var a=Object(g.a)({},this.state.userSubscriptions);a[e]=t,this.setStateAttributes({userSubscriptions:a})}},{key:"toggleHidden",value:function(e){return this.toggleProperty(e,"hidden")}},{key:"toggleFavorite",value:function(e){return this.toggleProperty(e,"favorite")}},{key:"getFeatures",value:function(e){return A.a.reduce(e,function(e,t,a){return t&&e.push(a),e},[]).join(",")}},{key:"render",value:function(){var e=this,t=A.a.keys(this.state.allCities).sort(function(t,a){var n=e.state.allCities[t],r=e.state[n][t],o=e.state.allCities[a],s=e.state[o][a];return r.favorite&&!s.favorite?-1:s.favorite&&!r.favorite?1:t.localeCompare(a)});return r.a.createElement(I.MuiThemeProvider,{theme:ft},r.a.createElement(v.b,{history:bt},r.a.createElement("div",{className:"App"},r.a.createElement(Et,{enabled:this.state.enabled,admin:this.state.admin,reloadAll:this.sendReload(null),grantAll:this.grantAll(),handleSwitch:this.toggleEnabled(),weatherCount:A.a.size(this.state.allCities),userCount:this.state.users.length,handleSearch:this.handleSearch(),handleLogout:this.logout(),userId:this.userId,features:this.state.features,setFeaturesEnabled:this.setFeaturesEnabled(),subscription:this.state.userSubscriptions&&this.state.userSubscriptions[this.userId],style:{width:"95%"}}),r.a.createElement(v.a,{path:"/weather/:city",exact:!0,render:function(t){return e.state.selectedValue&&r.a.createElement(vt,{data:e.state.selectedValue,onClose:e.handleDialogClose})}}),r.a.createElement(v.a,{path:"/weather",render:function(){return r.a.createElement("div",null,r.a.createElement(x.a,{container:!0,spacing:16,justify:"center"},A.a.map(t,function(t){return e.state[e.state.allCities[t]][t]&&e.state[e.state.allCities[t]][t].observation&&r.a.createElement(x.a,{item:!0,key:t,style:{display:e.state[e.state.allCities[t]][t].hidden?"none":"inherit"}},r.a.createElement(N.a,null,r.a.createElement(yt,{nowTime:e.state.nowTime,features:e.state.features,data:e.state[e.state.allCities[t]][t],toggleHidden:e.toggleHidden(t),toggleFavorite:e.toggleFavorite(t),showExtreme:e.state.showExtreme,showForecast:e.showForecast()})))})))}}),r.a.createElement(v.a,{path:"/users",exact:!0,render:function(){return r.a.createElement("div",null,r.a.createElement(x.a,{container:!0,spacing:16,justify:"center"},A.a.map(e.state.users,function(t){return r.a.createElement(x.a,{item:!0,key:t},r.a.createElement(N.a,null,r.a.createElement(wt,{user:t,admin:e.state.admin,features:e.state.features,subscription:e.state.userSubscriptions[t],reload:e.sendReload(t),setBasic:e.ungrantUser(t),setPro:e.grantUser(t),deleteForever:e.deleteForever(t)})))})))}}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(St,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[160,1,2]]]);
//# sourceMappingURL=main.1fdf65c4.chunk.js.map